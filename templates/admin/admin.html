{% extends 'base.html' %}

{% block title %}Painel Admin{% endblock %}

{% block content %}
    <h1>Painel do Administrador</h1>

    <h2>Adicionar Nova Marmita</h2>
    <form method="POST">
        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
        <label>Nome:</label><br>
        <input type="text" name="nome" required><br>
        <label>Preço:</label><br>
        <input type="number" step="0.01" name="preco" required><br>
        <label>Quantidade:</label><br>
        <input type="number" name="quantidade" min="0" required><br>
        <label>Descrição:</label><br>
        <textarea name="descricao" rows="3" cols="30"></textarea><br><br>
        <button type="submit">Adicionar Marmita</button>
    </form>

    <h2>Lista de Marmitas</h2>
    <ul>
        {% for marmita in marmitas %}
            <li class="marmita-item">
                <strong>{{ marmita.nome }}</strong> - 
                R$ {{ "%.2f"|format(marmita.preco) }} - 
                Estoque: {{ marmita.quantidade }}<br>

                {% if marmita.descricao %}
                    <em>{{ marmita.descricao }}</em><br>
                {% endif %}

                <form method="POST" action="{{ url_for('admin.atualizar_estoque', id=marmita.id) }}">
                    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
                    <label for="quantidade_adicional">Adicionar ao estoque:</label>
                    <input type="number" name="quantidade_adicional" min="1" required>
                    <button type="submit">Atualizar</button>
                </form>

                <a href="{{ url_for('admin.deletar_marmita', id=marmita.id) }}" onclick="return confirm('Deseja deletar esta marmita?')">Deletar</a>
            </li>
        {% endfor %}
    </ul>
{% endblock %}